var z=Object.defineProperty,H=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var S=Object.getOwnPropertySymbols;var v=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var P=(i,r,e)=>r in i?z(i,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[r]=e,U=(i,r)=>{for(var e in r||(r={}))v.call(r,e)&&P(i,e,r[e]);if(S)for(var e of S(r))I.call(r,e)&&P(i,e,r[e]);return i},B=(i,r)=>H(i,M(r));var X=(i,r,e)=>new Promise((_,d)=>{var f=l=>{try{a(e.next(l))}catch(s){d(s)}},T=l=>{try{a(e.throw(l))}catch(s){d(s)}},a=l=>l.done?_(l.value):Promise.resolve(l.value).then(f,T);a((e=e.apply(i,r)).next())});import J from"exceljs";import{saveAs as q}from"file-saver";var u={bottom:{color:{argb:"FF000000"},style:"thin"},top:{color:{argb:"FF000000"},style:"thin"},left:{color:{argb:"FF000000"},style:"thin"},right:{color:{argb:"FF000000"},style:"thin"}},y={horizontal:"center",vertical:"middle",wrapText:!0},$="Goudy Old Style",b=50,x={size:16,name:$},j="Goudy Old Style Bold",A=B(U({},x),{bold:!0,name:j}),k="#\u202F##0 [$F\u202FCFA-fr-CI];-#\u202F##0 [$F\u202FCFA-fr-CI]";var ot=i=>X(void 0,null,function*(){var O,w,D,N,R;let{data:r,config:e,rowAlignment:_,defaultFont:d,height:f,fileName:T,headers:a}=i,l=new J.Workbook,s=l.addWorksheet(e.name,{views:[{style:"pageBreakPreview"}],properties:{defaultRowHeight:(O=e.colHeight)!=null?O:b},headerFooter:{oddFooter:"&F&RPage &P / &N"},pageSetup:{paperSize:9,horizontalCentered:!0,scale:(w=e.zoom)!=null?w:100,orientation:(D=e.orientation)!=null?D:"portrait",margins:{top:.75,bottom:.75,left:.25,right:.25,header:.3,footer:.3}}});s.columns=a,s.eachRow(o=>{o.height=f!=null?f:b}),s.columns.forEach((o,m)=>{var n;(n=o.eachCell)==null||n.call(o,{includeEmpty:!1},g=>{var F,c,p,C;let t=a.at(m);g.border=(F=t==null?void 0:t.border)!=null?F:u,g.font=(c=t==null?void 0:t.font)!=null?c:A,o.alignment=(p=t==null?void 0:t.alignment)!=null?p:y,g.fill={pattern:"solid",type:"pattern",fgColor:{argb:"FFD9D9D9"}},(t!=null&&t.isCurrency||t!=null&&t.isNumber)&&(o.numFmt=((C=t==null?void 0:t.numFmt)!=null?C:t.isCurrency)?k:"#,##;-#,##")})});let h=s.addRows(r);h.length>0&&h.forEach((o,m)=>{o.height=b,o.eachCell({includeEmpty:!1},(n,g)=>{var F,c,p;let t=a.at(g-1);n.border=(F=t==null?void 0:t.border)!=null?F:u,n.alignment=(c=t==null?void 0:t.alignment)!=null?c:y,n.font=(p=t==null?void 0:t.font)!=null?p:x})});let E={};for(let o=0;o<a.length;o++){let m=a[o];m.hasTotal?E[(N=m.key)!=null?N:"-"]=0:E[(R=m.key)!=null?R:"-"]=null}let L=s.addRow(E);if(L.height=b,L.eachCell({includeEmpty:!0},(o,m)=>{var g,t,F;let n=a[m-1];if(o.border=(g=n==null?void 0:n.border)!=null?g:u,o.alignment=(t=n==null?void 0:n.alignment)!=null?t:y,o.font=(F=n==null?void 0:n.font)!=null?F:A,n!=null&&n.hasTotal){console.log(n);let c=o.address.replace(/[0-9]+/gi,"");o.value={date1904:!1,formula:`SUM(${c+"1"}:${c+(o.row-1)})`}}}),r.length<=0||a.length<=0)return;let G=yield l.xlsx.writeBuffer(),W=new Blob([G],{type:"applicationi/xlsx"});q(W,T.replace(/\.xlsx/gi,"")+".xlsx")});export{ot as generateXLSXGrid};
//# sourceMappingURL=index.mjs.map