"use strict";var $=Object.create;var y=Object.defineProperty,j=Object.defineProperties,J=Object.getOwnPropertyDescriptor,q=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertyNames,U=Object.getOwnPropertySymbols,Q=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var k=(n,o,e)=>o in n?y(n,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[o]=e,S=(n,o)=>{for(var e in o||(o={}))B.call(o,e)&&k(n,e,o[e]);if(U)for(var e of U(o))V.call(o,e)&&k(n,e,o[e]);return n},W=(n,o)=>j(n,q(o));var Y=(n,o)=>{for(var e in o)y(n,e,{get:o[e],enumerable:!0})},z=(n,o,e,p)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of K(o))!B.call(n,s)&&s!==e&&y(n,s,{get:()=>o[s],enumerable:!(p=J(o,s))||p.enumerable});return n};var Z=(n,o,e)=>(e=n!=null?$(Q(n)):{},z(o||!n||!n.__esModule?y(e,"default",{value:n,enumerable:!0}):e,n)),tt=n=>z(y({},"__esModule",{value:!0}),n);var G=(n,o,e)=>new Promise((p,s)=>{var b=l=>{try{a(e.next(l))}catch(m){s(m)}},x=l=>{try{a(e.throw(l))}catch(m){s(m)}},a=l=>l.done?p(l.value):Promise.resolve(l.value).then(b,x);a((e=e.apply(n,o)).next())});var et={};Y(et,{generateXLSXGrid:()=>ot});module.exports=tt(et);var M=Z(require("exceljs")),v=require("file-saver");var d={bottom:{color:{argb:"FF000000"},style:"thin"},top:{color:{argb:"FF000000"},style:"thin"},left:{color:{argb:"FF000000"},style:"thin"},right:{color:{argb:"FF000000"},style:"thin"}},T={horizontal:"center",vertical:"middle",wrapText:!0},E=50,h={size:16},_=W(S({},h),{bold:!0}),H="#,### [$F\u202FCFA-fr-CI];-#,### [$F\u202FCFA-fr-CI]";var ot=n=>G(void 0,null,function*(){var D,L,N,O,C;let{data:o,config:e,rowAlignment:p,defaultFont:s,height:b,fileName:x,headers:a}=n,l=new M.default.Workbook,m=l.addWorksheet(e.name,{views:[{style:"pageBreakPreview"}],properties:{defaultRowHeight:(D=e.colHeight)!=null?D:E},headerFooter:{oddFooter:"&F&RPage &P / &N"},pageSetup:{paperSize:9,horizontalCentered:!0,scale:(L=e.zoom)!=null?L:100,orientation:(N=e.orientation)!=null?N:"portrait",margins:{top:.75,bottom:.75,left:.25,right:.25,header:.3,footer:.3}}});m.columns=a,m.eachRow(r=>{r.height=b!=null?b:E}),m.columns.forEach((r,g)=>{var i;(i=r.eachCell)==null||i.call(r,{includeEmpty:!1},F=>{var f,c,u,P;let t=a.at(g);F.border=(f=t==null?void 0:t.border)!=null?f:d,F.font=(c=t==null?void 0:t.font)!=null?c:_,r.alignment=(u=t==null?void 0:t.alignment)!=null?u:T,F.fill={pattern:"solid",type:"pattern",fgColor:{argb:"FFD9D9D9"}},(t!=null&&t.isCurrency||t!=null&&t.isNumber)&&(r.numFmt=((P=t==null?void 0:t.numFmt)!=null?P:t.isCurrency)?H:"#,##;-#,##",console.log(r.numFmt))})});let w=m.addRows(o);w.length>0&&w.forEach((r,g)=>{r.height=E,r.eachCell({includeEmpty:!1},(i,F)=>{var f,c,u;let t=a.at(F-1);i.border=(f=t==null?void 0:t.border)!=null?f:d,i.alignment=(c=t==null?void 0:t.alignment)!=null?c:T,i.font=(u=t==null?void 0:t.font)!=null?u:h})});let A={};for(let r=0;r<a.length;r++){let g=a[r];g.hasTotal?A[(O=g.key)!=null?O:"-"]=0:A[(C=g.key)!=null?C:"-"]=null}let R=m.addRow(A);if(R.height=E,R.eachCell({includeEmpty:!0},(r,g)=>{var F,t,f;let i=a[g-1];if(r.border=(F=i==null?void 0:i.border)!=null?F:d,r.alignment=(t=i==null?void 0:i.alignment)!=null?t:T,r.font=(f=i==null?void 0:i.font)!=null?f:_,i!=null&&i.hasTotal){console.log(i);let c=r.address.replace(/[0-9]+/gi,"");r.value={date1904:!1,formula:`SUM(${c+"1"}:${c+(r.row-1)})`}}}),o.length<=0||a.length<=0)return;let I=yield l.xlsx.writeBuffer(),X=new Blob([I],{type:"applicationi/xlsx"});(0,v.saveAs)(X,x.replace(/\.xlsx/gi,"")+".xlsx")});0&&(module.exports={generateXLSXGrid});
//# sourceMappingURL=index.js.map