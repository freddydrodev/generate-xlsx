"use strict";var $=Object.create;var y=Object.defineProperty,j=Object.defineProperties,J=Object.getOwnPropertyDescriptor,q=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertyNames,P=Object.getOwnPropertySymbols,Q=Object.getPrototypeOf,B=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var U=(n,o,e)=>o in n?y(n,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):n[o]=e,X=(n,o)=>{for(var e in o||(o={}))B.call(o,e)&&U(n,e,o[e]);if(P)for(var e of P(o))V.call(o,e)&&U(n,e,o[e]);return n},k=(n,o)=>j(n,q(o));var Y=(n,o)=>{for(var e in o)y(n,e,{get:o[e],enumerable:!0})},G=(n,o,e,p)=>{if(o&&typeof o=="object"||typeof o=="function")for(let s of K(o))!B.call(n,s)&&s!==e&&y(n,s,{get:()=>o[s],enumerable:!(p=J(o,s))||p.enumerable});return n};var Z=(n,o,e)=>(e=n!=null?$(Q(n)):{},G(o||!n||!n.__esModule?y(e,"default",{value:n,enumerable:!0}):e,n)),tt=n=>G(y({},"__esModule",{value:!0}),n);var W=(n,o,e)=>new Promise((p,s)=>{var b=l=>{try{a(e.next(l))}catch(m){s(m)}},x=l=>{try{a(e.throw(l))}catch(m){s(m)}},a=l=>l.done?p(l.value):Promise.resolve(l.value).then(b,x);a((e=e.apply(n,o)).next())});var rt={};Y(rt,{generateXLSXGrid:()=>nt});module.exports=tt(rt);var H=Z(require("exceljs")),M=require("file-saver");var T={bottom:{color:{argb:"FF000000"},style:"thin"},top:{color:{argb:"FF000000"},style:"thin"},left:{color:{argb:"FF000000"},style:"thin"},right:{color:{argb:"FF000000"},style:"thin"}},E={horizontal:"center",vertical:"middle",wrapText:!0},ot="Goudy Old Style",d=50,_={size:16,name:ot},et="Goudy Old Style Bold",h=k(X({},_),{bold:!0,name:et}),z="#\u202F##0 [$F\u202FCFA-fr-CI];-#\u202F##0 [$F\u202FCFA-fr-CI]";var nt=n=>W(void 0,null,function*(){var w,D,N,R,C;let{data:o,config:e,rowAlignment:p,defaultFont:s,height:b,fileName:x,headers:a}=n,l=new H.default.Workbook,m=l.addWorksheet(e.name,{views:[{style:"pageBreakPreview"}],properties:{defaultRowHeight:(w=e.colHeight)!=null?w:d},headerFooter:{oddFooter:"&F&RPage &P / &N"},pageSetup:{paperSize:9,horizontalCentered:!0,scale:(D=e.zoom)!=null?D:100,orientation:(N=e.orientation)!=null?N:"portrait",margins:{top:.75,bottom:.75,left:.25,right:.25,header:.3,footer:.3}}});m.columns=a,m.eachRow(r=>{r.height=b!=null?b:d}),m.columns.forEach((r,g)=>{var i;(i=r.eachCell)==null||i.call(r,{includeEmpty:!1},F=>{var c,f,u,S;let t=a.at(g);F.border=(c=t==null?void 0:t.border)!=null?c:T,F.font=(f=t==null?void 0:t.font)!=null?f:h,r.alignment=(u=t==null?void 0:t.alignment)!=null?u:E,F.fill={pattern:"solid",type:"pattern",fgColor:{argb:"FFD9D9D9"}},(t!=null&&t.isCurrency||t!=null&&t.isNumber)&&(r.numFmt=((S=t==null?void 0:t.numFmt)!=null?S:t.isCurrency)?z:"#,##;-#,##")})});let L=m.addRows(o);L.length>0&&L.forEach((r,g)=>{r.height=d,r.eachCell({includeEmpty:!1},(i,F)=>{var c,f,u;let t=a.at(F-1);i.border=(c=t==null?void 0:t.border)!=null?c:T,i.alignment=(f=t==null?void 0:t.alignment)!=null?f:E,i.font=(u=t==null?void 0:t.font)!=null?u:_})});let A={};for(let r=0;r<a.length;r++){let g=a[r];g.hasTotal?A[(R=g.key)!=null?R:"-"]=0:A[(C=g.key)!=null?C:"-"]=null}let O=m.addRow(A);if(O.height=d,O.eachCell({includeEmpty:!0},(r,g)=>{var F,t,c;let i=a[g-1];if(r.border=(F=i==null?void 0:i.border)!=null?F:T,r.alignment=(t=i==null?void 0:i.alignment)!=null?t:E,r.font=(c=i==null?void 0:i.font)!=null?c:h,i!=null&&i.hasTotal){console.log(i);let f=r.address.replace(/[0-9]+/gi,"");r.value={date1904:!1,formula:`SUM(${f+"1"}:${f+(r.row-1)})`}}}),o.length<=0||a.length<=0)return;let v=yield l.xlsx.writeBuffer(),I=new Blob([v],{type:"applicationi/xlsx"});(0,M.saveAs)(I,x.replace(/\.xlsx/gi,"")+".xlsx")});0&&(module.exports={generateXLSXGrid});
//# sourceMappingURL=index.js.map